import requestScenariosAction from '../actions/requestScenariosAction';
import { ARCHIVE_SCENARIO } from '../constants/actionTypes';
import batchManagementApiFactory from '../shared/batchManagementApiFactory';

const archiveScenariosEpic = (action$, { getState }) =>
  action$.ofType(ARCHIVE_SCENARIO).mergeMap($action => {
    const scenarioIdList = $action.payload;

    const apiStream = batchManagementApiFactory(getState())
      .deleteScenarios(scenarioIdList)
      .map(requestScenariosAction);

    return apiStream;
  });

export default archiveScenariosEpic;
