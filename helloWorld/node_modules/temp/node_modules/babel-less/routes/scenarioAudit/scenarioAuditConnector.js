import { connect } from 'react-redux';
import requestScenariosAudit from '../../actions/requestScenariosAuditAction';
import { SCENARIOS } from '../../constants/reducerTypes';
import {
  CAN_EDIT,
  SCENARIO_LIST,
  SCENARIO_AUDIT_LIST,
  FILTER,
} from '../../constants/stateConstants';
import { REQUEST_SCENARIOS_AUDIT } from '../../constants/actionTypes';
import getPrinciple from '../../../auth/selectors/getPrinciple';
import Entitlement from '../../../auth/model/entitlement';

/* Externalise connecting to redux */

const mapStateToProps = state => {
  const mapppedState = {
    [SCENARIO_AUDIT_LIST]: state[SCENARIOS][SCENARIO_AUDIT_LIST],
    [FILTER]: state[SCENARIOS][FILTER],
    [CAN_EDIT]:
      getPrinciple(state).hasRole('ADMIN') ||
      getPrinciple(state).hasOneOrMoreEntitlements(
        Entitlement.from('ui.batch-management', 'read-write')
      ),
  };

  return mapppedState;
};

const mapActionsToProps = {
  [REQUEST_SCENARIOS_AUDIT]: requestScenariosAudit,
};

const connector = Component =>
  connect(mapStateToProps, mapActionsToProps)(Component);

export default connector;
